# Extended Module Player Makefile.rules.in
# $Id: Makefile.rules.in,v 1.37 2007-09-17 11:51:22 cmatsuoka Exp $

VERSION		= 2.2.2
DATE		= Mon Sep 17 07:40:07 BRT 2007

DESTDIR		=
prefix		= @prefix@
exec_prefix	= @prefix@
datarootdir	= @datarootdir@
BINDIR		= @bindir@
LIBDIR		= @libdir@
MANDIR		= @mandir@/man1
SYSCONFDIR	= @sysconfdir@/xmp

CC		= @CC@
CFLAGS		= -c @CFLAGS@ @DEFS@ @CINCS@ #-D_DEBUG
LD		= @CC@
LDFLAGS		= -o $@ @LDFLAGS@
RANLIB		= @RANLIB@
INSTALL		= @INSTALL@

PLUGDIR		= @PLUGDIR@
PLUGFLAGS	= -fPIC @PLUGFLAGS@
PLUGINST	= @PLUGINST@

ifneq ($(PLUGDIR),)
LOBJS		= $(OBJS:.o=.lo)
XLOBJS		= $(XOBJS:.o=.lo)
LLIB		= $(LIB:.a=-pic.a)
endif


# IRIX 6.5.10 note by Johan Hattne <hattne@ibg.uu.se>
# (Thu, 15 Feb 2001 20:20:38 +0100)
#
# I moved -laudio from just after -lXext to after -lm. It seems gcc
# [2.95.2 as supplied by the freeware.sgi.com site] has problems
# resolving the audio-symbols otherwise.
#
# LIBS		= @LIBS@ $(XLIBS)

LIBS		= $(XLIBS) @LIBS@
SHELL		= /bin/sh
PLATFORM	= @PLATFORM@

DRIVERS		= @DRIVERS@
MIXER		= @MIXER@

LOBJS	= $(OBJS:.o=.lo)

.SUFFIXES: .c .o .lo .a .S .so

.c.o:
	$(CC) $(CFLAGS) $(XCFLAGS) -o $*.o $<

.c.lo:
	$(CC) $(CFLAGS) -fPIC $(XCFLAGS) -o $*.lo $<

.S.o:
	$(CC) $(CFLAGS) -o $*.o $<

.lo.so:
	ld -shared -o $*.so $<

dummy:

$(LIB): $(LIB)($(OBJS) $(XOBJS)) $(LLIB)
	$(RANLIB) $(LIB)

$(LLIB): $(LLIB)($(LOBJS) $(XLOBJS))
	$(RANLIB) $(LLIB)

depend:
	@echo Building dependencies...
	@$(CC) $(CFLAGS) $(XCFLAGS) -MM -MG $(OBJS:.o=.c) $(XDEPS:.o=.c) >$@

clean distclean::
	rm -f *.o *.lo core errlist depend $(CFILES)
ifdef DDIRS
	@for i in $(DDIRS); do \
		if [ -d $$i ]; then \
			(cd $$i && [ -f Makefile ] && $(MAKE) $@) \
		fi \
	done; true
endif

distclean::
	rm -f $(DCFILES)

install::
ifdef DDIRS
	@for i in $(DDIRS); do \
		if [ -d $$i ]; then \
			(cd $$i && [ -f Makefile ] && $(MAKE) $@) \
		fi \
	done; true 
endif

subdist::
	cp -dp $(DFILES) $(DISTDIR)
ifdef DDIRS
	for i in $(DDIRS); do \
		mkdir $(DISTDIR)/$$i; \
		( cd $$i; \
		if [ -f Makefile ]; then \
			$(MAKE) VERSION=$(VERSION) DISTDIR=../$(DISTDIR)/$$i \
			subdist; \
		else \
			for j in *; do \
				[ -f $$j ] && cp -dp $$j ../$(DISTDIR)/$$i; \
			done; true; \
		fi; ) \
	done
endif

